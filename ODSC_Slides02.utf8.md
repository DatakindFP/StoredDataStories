---
title: "Water Solubility"
author: "Paul J. Kowalczyk"
date: "2019-10-30"
output:
  slidy_presentation:
    df_print: paged
  
---


## The ODSC Logo

![](graphics/odsc.jpg)
... and a link to [ODSC West](https://odsc.com/california/)

## Read Data


```r
df <-
  read.csv('data/water_solubility.csv',
           header = TRUE,
           stringsAsFactors = FALSE) %>%
  na.omit()

head(df[sample(nrow(df), 10), ])
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["CAS"],"name":[1],"type":["chr"],"align":["left"]},{"label":["LogMolar"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["BalabanJ"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["BertzCT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Chi0"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Chi0n"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Chi0v"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Chi1"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["Chi1n"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["Chi1v"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["Chi2n"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["Chi2v"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["Chi3n"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["Chi3v"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["Chi4n"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["Chi4v"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["EState_VSA1"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["EState_VSA10"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["EState_VSA11"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["EState_VSA2"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["EState_VSA3"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["EState_VSA4"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["EState_VSA5"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["EState_VSA6"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["EState_VSA7"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["EState_VSA8"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["EState_VSA9"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["ExactMolWt"],"name":[28],"type":["dbl"],"align":["right"]},{"label":["FpDensityMorgan1"],"name":[29],"type":["dbl"],"align":["right"]},{"label":["FpDensityMorgan2"],"name":[30],"type":["dbl"],"align":["right"]},{"label":["FpDensityMorgan3"],"name":[31],"type":["dbl"],"align":["right"]},{"label":["FractionCSP3"],"name":[32],"type":["dbl"],"align":["right"]},{"label":["HallKierAlpha"],"name":[33],"type":["dbl"],"align":["right"]},{"label":["HeavyAtomCount"],"name":[34],"type":["int"],"align":["right"]},{"label":["HeavyAtomMolWt"],"name":[35],"type":["dbl"],"align":["right"]},{"label":["Ipc"],"name":[36],"type":["dbl"],"align":["right"]},{"label":["Kappa1"],"name":[37],"type":["dbl"],"align":["right"]},{"label":["Kappa2"],"name":[38],"type":["dbl"],"align":["right"]},{"label":["Kappa3"],"name":[39],"type":["dbl"],"align":["right"]},{"label":["LabuteASA"],"name":[40],"type":["dbl"],"align":["right"]},{"label":["MaxAbsEStateIndex"],"name":[41],"type":["dbl"],"align":["right"]},{"label":["MaxAbsPartialCharge"],"name":[42],"type":["dbl"],"align":["right"]},{"label":["MaxEStateIndex"],"name":[43],"type":["dbl"],"align":["right"]},{"label":["MaxPartialCharge"],"name":[44],"type":["dbl"],"align":["right"]},{"label":["MinAbsEStateIndex"],"name":[45],"type":["dbl"],"align":["right"]},{"label":["MinAbsPartialCharge"],"name":[46],"type":["dbl"],"align":["right"]},{"label":["MinEStateIndex"],"name":[47],"type":["dbl"],"align":["right"]},{"label":["MinPartialCharge"],"name":[48],"type":["dbl"],"align":["right"]},{"label":["MolLogP"],"name":[49],"type":["dbl"],"align":["right"]},{"label":["MolMR"],"name":[50],"type":["dbl"],"align":["right"]},{"label":["MolWt"],"name":[51],"type":["dbl"],"align":["right"]},{"label":["NHOHCount"],"name":[52],"type":["int"],"align":["right"]},{"label":["NOCount"],"name":[53],"type":["int"],"align":["right"]},{"label":["NumAliphaticCarbocycles"],"name":[54],"type":["int"],"align":["right"]},{"label":["NumAliphaticHeterocycles"],"name":[55],"type":["int"],"align":["right"]},{"label":["NumAliphaticRings"],"name":[56],"type":["int"],"align":["right"]},{"label":["NumAromaticCarbocycles"],"name":[57],"type":["int"],"align":["right"]},{"label":["NumAromaticHeterocycles"],"name":[58],"type":["int"],"align":["right"]},{"label":["NumAromaticRings"],"name":[59],"type":["int"],"align":["right"]},{"label":["NumHAcceptors"],"name":[60],"type":["int"],"align":["right"]},{"label":["NumHDonors"],"name":[61],"type":["int"],"align":["right"]},{"label":["NumHeteroatoms"],"name":[62],"type":["int"],"align":["right"]},{"label":["NumRadicalElectrons"],"name":[63],"type":["int"],"align":["right"]},{"label":["NumRotatableBonds"],"name":[64],"type":["int"],"align":["right"]},{"label":["NumSaturatedCarbocycles"],"name":[65],"type":["int"],"align":["right"]},{"label":["NumSaturatedHeterocycles"],"name":[66],"type":["int"],"align":["right"]},{"label":["NumSaturatedRings"],"name":[67],"type":["int"],"align":["right"]},{"label":["NumValenceElectrons"],"name":[68],"type":["int"],"align":["right"]},{"label":["PEOE_VSA1"],"name":[69],"type":["dbl"],"align":["right"]},{"label":["PEOE_VSA10"],"name":[70],"type":["dbl"],"align":["right"]},{"label":["PEOE_VSA11"],"name":[71],"type":["dbl"],"align":["right"]},{"label":["PEOE_VSA12"],"name":[72],"type":["dbl"],"align":["right"]},{"label":["PEOE_VSA13"],"name":[73],"type":["dbl"],"align":["right"]},{"label":["PEOE_VSA14"],"name":[74],"type":["dbl"],"align":["right"]},{"label":["PEOE_VSA2"],"name":[75],"type":["dbl"],"align":["right"]},{"label":["PEOE_VSA3"],"name":[76],"type":["dbl"],"align":["right"]},{"label":["PEOE_VSA4"],"name":[77],"type":["dbl"],"align":["right"]},{"label":["PEOE_VSA5"],"name":[78],"type":["dbl"],"align":["right"]},{"label":["PEOE_VSA6"],"name":[79],"type":["dbl"],"align":["right"]},{"label":["PEOE_VSA7"],"name":[80],"type":["dbl"],"align":["right"]},{"label":["PEOE_VSA8"],"name":[81],"type":["dbl"],"align":["right"]},{"label":["PEOE_VSA9"],"name":[82],"type":["dbl"],"align":["right"]},{"label":["RingCount"],"name":[83],"type":["int"],"align":["right"]},{"label":["SMR_VSA1"],"name":[84],"type":["dbl"],"align":["right"]},{"label":["SMR_VSA10"],"name":[85],"type":["dbl"],"align":["right"]},{"label":["SMR_VSA2"],"name":[86],"type":["dbl"],"align":["right"]},{"label":["SMR_VSA3"],"name":[87],"type":["dbl"],"align":["right"]},{"label":["SMR_VSA4"],"name":[88],"type":["dbl"],"align":["right"]},{"label":["SMR_VSA5"],"name":[89],"type":["dbl"],"align":["right"]},{"label":["SMR_VSA6"],"name":[90],"type":["dbl"],"align":["right"]},{"label":["SMR_VSA7"],"name":[91],"type":["dbl"],"align":["right"]},{"label":["SMR_VSA8"],"name":[92],"type":["int"],"align":["right"]},{"label":["SMR_VSA9"],"name":[93],"type":["dbl"],"align":["right"]},{"label":["SlogP_VSA1"],"name":[94],"type":["dbl"],"align":["right"]},{"label":["SlogP_VSA10"],"name":[95],"type":["dbl"],"align":["right"]},{"label":["SlogP_VSA11"],"name":[96],"type":["dbl"],"align":["right"]},{"label":["SlogP_VSA12"],"name":[97],"type":["dbl"],"align":["right"]},{"label":["SlogP_VSA2"],"name":[98],"type":["dbl"],"align":["right"]},{"label":["SlogP_VSA3"],"name":[99],"type":["dbl"],"align":["right"]},{"label":["SlogP_VSA4"],"name":[100],"type":["dbl"],"align":["right"]},{"label":["SlogP_VSA5"],"name":[101],"type":["dbl"],"align":["right"]},{"label":["SlogP_VSA6"],"name":[102],"type":["dbl"],"align":["right"]},{"label":["SlogP_VSA7"],"name":[103],"type":["dbl"],"align":["right"]},{"label":["SlogP_VSA8"],"name":[104],"type":["dbl"],"align":["right"]},{"label":["SlogP_VSA9"],"name":[105],"type":["int"],"align":["right"]},{"label":["TPSA"],"name":[106],"type":["dbl"],"align":["right"]},{"label":["VSA_EState1"],"name":[107],"type":["int"],"align":["right"]},{"label":["VSA_EState10"],"name":[108],"type":["dbl"],"align":["right"]},{"label":["VSA_EState2"],"name":[109],"type":["dbl"],"align":["right"]},{"label":["VSA_EState3"],"name":[110],"type":["int"],"align":["right"]},{"label":["VSA_EState4"],"name":[111],"type":["dbl"],"align":["right"]},{"label":["VSA_EState5"],"name":[112],"type":["int"],"align":["right"]},{"label":["VSA_EState6"],"name":[113],"type":["int"],"align":["right"]},{"label":["VSA_EState7"],"name":[114],"type":["int"],"align":["right"]},{"label":["VSA_EState8"],"name":[115],"type":["dbl"],"align":["right"]},{"label":["VSA_EState9"],"name":[116],"type":["dbl"],"align":["right"]},{"label":["qed"],"name":[117],"type":["dbl"],"align":["right"]}],"data":[{"1":"132-65-0","2":"-5.0981","3":"2.642438","4":"512.88414","5":"8.673362","6":"7.027050","7":"7.843547","8":"6.449490","9":"4.312949","10":"5.129445","11":"3.094381","12":"4.178158","13":"2.2842067","14":"3.436025","15":"1.6747664","16":"2.7808168","17":"0.000000","18":"0.000000","19":"0","20":"0.000000","21":"0.000000","22":"0.00000","23":"20.17229","24":"0.00000","25":"11.33679","26":"48.53094","27":"0.00000","28":"184.03467","29":"0.6153846","30":"1.076923","31":"1.615385","32":"0.0000000","33":"-1.34","34":"13","35":"176.199","36":"2395.23819","37":"7.100870","38":"2.573620","39":"0.9732863","40":"80.43510","41":"2.188657","42":"0.1351911","43":"2.188657","44":"0.03548923","45":"1.37787037","46":"0.03548923","47":"1.37787037","48":"-0.1351911","49":"4.0545","50":"59.3310","51":"184.263","52":"0","53":"0","54":"0","55":"0","56":"0","57":"2","58":"1","59":"3","60":"1","61":"0","62":"1","63":"0","64":"0","65":"0","66":"0","67":"0","68":"62","69":"0.000000","70":"0.000000","71":"0.000000","72":"0.00000","73":"0.000000","74":"0.000000","75":"0.000000","76":"0.000000","77":"0.0000","78":"11.33679","79":"36.398202","80":"12.132734","81":"20.172288","82":"0.000000","83":"3","84":"0.000000","85":"31.50907","86":"0","87":"0.00000","88":"0","89":"0.000000","90":"0.000000","91":"48.53094","92":"0","93":"0.00000","94":"0.000000","95":"0.000000","96":"0","97":"11.33679","98":"0.000000","99":"0.000000","100":"0.00000","101":"0.000000","102":"48.53094","103":"0","104":"20.17229","105":"0","106":"0.00","107":"0","108":"1.861667","109":"0","110":"0","111":"0","112":"0","113":"0","114":"0","115":"0.000000","116":"22.6383333","117":"0.4940582","_rn_":"967"},{"1":"1239-45-8","2":"-1.2948","3":"2.274341","4":"1053.00592","5":"16.681434","6":"13.659874","7":"13.659874","8":"11.685872","9":"8.184650","10":"8.184650","11":"6.040499","12":"6.040499","13":"4.5348717","14":"4.534872","15":"3.4940629","16":"3.4940629","17":"0.000000","18":"0.000000","19":"0","20":"0.000000","21":"0.000000","22":"23.43623","23":"27.41605","24":"0.00000","25":"18.19910","26":"60.02177","27":"11.46733","28":"314.16517","29":"0.7500000","30":"1.416667","31":"2.125000","32":"0.0952381","33":"-3.07","34":"24","35":"294.252","36":"449292.42263","37":"14.517720","38":"5.532152","39":"2.1722380","40":"140.69111","41":"6.101299","42":"0.3987075","43":"6.101299","44":"0.22047834","45":"0.77511963","46":"0.22047834","47":"0.77511963","48":"-0.3987075","49":"4.1318","50":"101.5838","51":"314.412","52":"4","53":"3","54":"0","55":"0","56":"0","57":"3","58":"1","59":"4","60":"2","61":"2","62":"3","63":"0","64":"2","65":"0","66":"0","67":"0","68":"118","69":"11.467335","70":"6.544756","71":"0.000000","72":"11.21063","73":"0.000000","74":"0.000000","75":"0.000000","76":"0.000000","77":"4.5671","78":"0.00000","79":"24.265468","80":"43.321940","81":"28.390815","82":"10.772448","83":"4","84":"4.567100","85":"33.05015","86":"0","87":"0.00000","88":"0","89":"13.468494","90":"11.467335","91":"66.73004","92":"0","93":"11.25738","94":"16.034435","95":"11.374773","96":"0","97":"0.00000","98":"0.000000","99":"6.544756","100":"0.00000","101":"6.923737","102":"66.73004","103":"0","104":"32.93275","105":"0","106":"55.92","107":"0","108":"0.000000","109":"0","110":"0","111":"0","112":"0","113":"0","114":"0","115":"2.322222","116":"46.5111111","117":"0.3319038","_rn_":"3736"},{"1":"20893-64-5","2":"-0.2225","3":"2.521182","4":"85.72121","5":"4.405777","6":"3.178304","7":"3.994800","8":"2.893847","9":"1.739086","10":"2.618738","11":"1.065769","12":"2.028978","13":"0.5802301","14":"1.338321","15":"0.3164529","16":"0.8531337","17":"0.000000","18":"4.794537","19":"0","20":"5.115277","21":"6.420822","22":"0.00000","23":"11.76188","24":"0.00000","25":"11.48407","26":"0.00000","27":"0.00000","28":"99.99829","29":"1.8333333","30":"2.666667","31":"2.833333","32":"0.2500000","33":"-0.24","34":"6","35":"96.110","36":"33.54888","37":"3.933611","38":"1.472615","39":"0.6267764","40":"40.42328","41":"10.143519","42":"0.2865136","43":"10.143519","44":"0.19638237","45":"0.25925926","46":"0.19638237","47":"0.25925926","48":"-0.2865136","49":"1.1636","50":"26.3550","51":"100.142","52":"0","53":"1","54":"0","55":"1","56":"1","57":"0","58":"0","59":"0","60":"2","61":"0","62":"2","63":"0","64":"0","65":"0","66":"0","67":"0","68":"32","69":"0.000000","70":"0.000000","71":"5.115277","72":"0.00000","73":"0.000000","74":"0.000000","75":"4.794537","76":"0.000000","77":"0.0000","78":"0.00000","79":"17.837905","80":"5.408052","81":"6.420822","82":"0.000000","83":"1","84":"4.794537","85":"16.87716","86":"0","87":"0.00000","88":"0","89":"6.420822","90":"0.000000","91":"11.48407","92":"0","93":"0.00000","94":"0.000000","95":"0.000000","96":"0","97":"11.76188","98":"5.115277","99":"4.794537","100":"0.00000","101":"6.420822","102":"11.48407","103":"0","104":"0.00000","105":"0","106":"17.07","107":"0","108":"1.277778","109":"0","110":"0","111":"0","112":"0","113":"0","114":"0","115":"0.000000","116":"14.7222222","117":"0.4541289","_rn_":"2430"},{"1":"126-72-7","2":"-4.9405","3":"4.448418","4":"254.81735","5":"15.596012","6":"10.322685","7":"20.733092","8":"9.363521","9":"5.502249","10":"13.074276","11":"3.589267","12":"11.085615","13":"1.7427745","14":"9.854235","15":"0.7619246","16":"3.6431659","17":"7.822697","18":"4.565048","19":"0","20":"34.302168","21":"15.990269","22":"0.00000","23":"0.00000","24":"0.00000","25":"0.00000","26":"95.57966","27":"13.57124","28":"691.58082","29":"0.7000000","30":"0.950000","31":"1.150000","32":"1.0000000","33":"2.99","34":"20","35":"682.493","36":"16027.43616","37":"22.990000","38":"13.299776","39":"11.5141599","40":"169.75432","41":"12.499232","42":"0.4743954","43":"12.499232","44":"0.47439545","45":"0.03695345","46":"0.28566415","47":"-3.57303241","48":"-0.2856642","49":"5.6195","50":"104.9895","51":"697.613","52":"0","53":"4","54":"0","55":"0","56":"0","57":"0","58":"0","59":"0","60":"4","61":"0","62":"11","63":"0","64":"12","65":"0","66":"0","67":"0","68":"122","69":"0.000000","70":"0.000000","71":"0.000000","72":"0.00000","73":"0.000000","74":"7.822697","75":"13.571241","76":"4.565048","77":"0.0000","78":"0.00000","79":"95.579663","80":"0.000000","81":"30.471791","82":"19.820646","83":"0","84":"18.136290","85":"103.40236","86":"0","87":"0.00000","88":"0","89":"14.481522","90":"35.810915","91":"0.00000","92":"0","93":"0.00000","94":"0.000000","95":"0.000000","96":"0","97":"103.40236","98":"50.292437","99":"18.136290","100":"0.00000","101":"0.000000","102":"0.00000","103":"0","104":"0.00000","105":"0","106":"44.76","107":"0","108":"0.000000","109":"0","110":"0","111":"0","112":"0","113":"0","114":"0","115":"28.501416","116":"-0.7449208","117":"0.1964854","_rn_":"940"},{"1":"81475-37-8","2":"-3.0266","3":"1.909949","4":"351.26745","5":"14.468409","6":"12.735931","7":"12.735931","8":"9.842535","9":"8.025199","10":"8.025199","11":"5.326028","12":"5.326028","13":"3.4896129","14":"3.489613","15":"2.2367150","16":"2.2367150","17":"0.000000","18":"4.794537","19":"0","20":"5.907180","21":"5.563451","22":"12.96558","23":"51.36657","24":"24.52642","25":"0.00000","26":"17.22450","27":"0.00000","28":"276.22016","29":"1.0500000","30":"1.700000","31":"2.300000","32":"0.6470588","33":"-1.38","34":"20","35":"248.200","36":"35101.65128","37":"16.673706","38":"11.446972","39":"7.9251571","40":"122.74174","41":"11.729130","42":"0.3519912","43":"11.729130","44":"0.25234480","45":"0.01605035","46":"0.25234480","47":"-0.01605035","48":"-0.3519912","49":"4.3422","50":"83.7972","51":"276.424","52":"1","53":"3","54":"0","55":"0","56":"0","57":"0","58":"1","59":"1","60":"2","61":"1","62":"3","63":"0","64":"11","65":"0","66":"0","67":"0","68":"112","69":"5.316789","70":"0.000000","71":"0.000000","72":"0.00000","73":"5.907180","74":"0.000000","75":"9.778516","76":"0.000000","77":"0.0000","78":"0.00000","79":"58.290310","80":"18.553556","81":"18.938444","82":"5.563451","83":"1","84":"4.794537","85":"5.90718","86":"0","87":"10.30077","88":"0","89":"64.711132","90":"6.544756","91":"30.08987","92":"0","93":"0.00000","94":"5.316789","95":"0.000000","96":"0","97":"0.00000","98":"17.435915","99":"0.000000","100":"0.00000","101":"75.069120","102":"24.52642","103":"0","104":"0.00000","105":"0","106":"41.99","107":"0","108":"0.000000","109":"0","110":"0","111":"0","112":"0","113":"0","114":"0","115":"0.000000","116":"40.8333333","117":"0.6107404","_rn_":"2920"},{"1":"21161-11-5","2":"-1.9901","3":"3.555945","4":"420.19516","5":"11.585422","6":"7.206685","7":"7.206685","8":"6.947265","9":"3.688234","10":"3.688234","11":"2.569155","12":"2.569155","13":"1.6794141","14":"1.679414","15":"1.0853666","16":"1.0853666","17":"33.676211","18":"19.703393","19":"0","20":"0.000000","21":"0.000000","22":"18.19910","23":"0.00000","24":"0.00000","25":"0.00000","26":"0.00000","27":"10.21305","28":"211.01169","29":"1.1333333","30":"1.533333","31":"1.800000","32":"0.0000000","33":"-2.44","34":"15","35":"206.089","36":"1720.96044","37":"10.639618","38":"3.742224","39":"1.9033692","40":"82.72577","41":"10.603649","42":"0.4774545","43":"10.603649","44":"0.34225530","45":"0.63898148","46":"0.34225530","47":"-1.53722222","48":"-0.4774545","49":"0.9912","50":"47.0150","51":"211.129","52":"2","53":"7","54":"0","55":"0","56":"0","57":"1","58":"0","59":"1","60":"4","61":"2","62":"7","63":"0","64":"3","65":"0","66":"0","67":"0","68":"78","69":"10.213055","70":"11.126903","71":"0.000000","72":"0.00000","73":"5.687386","74":"11.938611","75":"10.114318","76":"9.589074","77":"0.0000","78":"0.00000","79":"6.066367","80":"12.132734","81":"0.000000","82":"4.923311","83":"1","84":"24.725440","85":"17.62600","86":"0","87":"0.00000","88":"0","89":"0.000000","90":"0.000000","91":"39.44032","92":"0","93":"0.00000","94":"0.000000","95":"5.687386","96":"0","97":"0.00000","98":"27.074976","99":"0.000000","100":"10.11432","101":"20.715977","102":"18.19910","103":"0","104":"0.00000","105":"0","106":"117.74","107":"0","108":"0.000000","109":"0","110":"0","111":"0","112":"0","113":"0","114":"0","115":"0.000000","116":"56.3333333","117":"0.5680355","_rn_":"3975"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

## Distribution of Endpoint Values  


```r
LogMolar <-
  ggplot(df, aes(LogMolar, stat(density))) +
  geom_histogram(binwidth = 0.25, color = 'white', fill = 'blue') +
  theme(legend.position = "none") +
  ggthemes::theme_hc()
LogMolar
```

<img src="ODSC_Slides02_files/figure-slidy/endpoint_distribution-1.png" width="768" />

## Build training and test sets

 + stratified data partition: LogMolar  
 + 80% train / 20% test

<img src="ODSC_Slides02_files/figure-slidy/train_test-1.png" width="768" />

## Data Curation: near-zero variance  

Initial number of variables in the dataset: 115.

The variables with near-zero variance are:

```r
nzv <- caret::nearZeroVar(X_train, freqCut = 100/0)
names(df[ , nzv])
```

```
## [1] "NumHDonors"   "SMR_VSA6"     "SlogP_VSA7"   "SlogP_VSA9"  
## [5] "VSA_EState10" "VSA_EState3"  "VSA_EState4"  "VSA_EState5"
```

Remove the near-zero variance variables

```r
X_train <- X_train[ , -nzv]
X_test <- X_test[ , -nzv]
```
Number of variables in the dataset, following removal of those with near zero variance: 107

## Data Curation: highly correlated variables

For all pairs of variables whose pairwise correlation exceeds 0.85, remove that variable whose mean correlation to all other variables is the greater.

Identify highly correlated variables

```r
allCorrelations <- cor(X_train)
highCorr <- findCorrelation(allCorrelations, cutoff = 0.85)
```





Remove highly correlated variables

```r
X_train <- X_train[ , -highCorr]
X_test <- X_test[ , -highCorr]
```
Having removed the highly correlated variables, there are 73 variables remaining. 



## Data Curation: names of removed variables (due to high correlation)

```
##  [1] "Chi0"                     "Chi1"                    
##  [3] "ExactMolWt"               "HeavyAtomCount"          
##  [5] "HeavyAtomMolWt"           "Kappa1"                  
##  [7] "LabuteASA"                "MinAbsPartialCharge"     
##  [9] "MolMR"                    "MolWt"                   
## [11] "NumAromaticRings"         "NumHDonors"              
## [13] "NumValenceElectrons"      "SMR_VSA7"                
## [15] "VSA_EState10"             "Chi0n"                   
## [17] "Chi0v"                    "Chi1n"                   
## [19] "Chi1v"                    "Chi2n"                   
## [21] "Chi2v"                    "Chi3n"                   
## [23] "Chi3v"                    "FpDensityMorgan1"        
## [25] "FpDensityMorgan2"         "MaxAbsEStateIndex"       
## [27] "MaxAbsPartialCharge"      "NOCount"                 
## [29] "Kappa2"                   "NumAliphaticCarbocycles" 
## [31] "NumAliphaticHeterocycles" "NumAliphaticRings"       
## [33] "SMR_VSA10"                "SMR_VSA5"
```

## Data Curation: Linear combinations

Identify variables that are a linear combination

```r
comboInfo <- findLinearCombos(X_train)
names(X_train[ , comboInfo$remove])
```

```
## [1] "NumSaturatedRings" "PEOE_VSA9"         "SlogP_VSA8"
```

Remove those variables that are a linear combination

```r
X_train <- X_train[ , -comboInfo$remove]
X_test <- X_test[ , -comboInfo$remove]
```

Having removed variables that are a linear combination, there are 70 variables in the dataset.

## Principal Components Analysis

<img src="ODSC_Slides02_files/figure-slidy/pca-1.png" width="768" />
